<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>What is Stack Smashing? Can it be Fixed? | ZestW</title><meta name=generator content="Hugo 0.98.0"><meta name=description content="Quick LinksWhat Is Stack Smashing?  Debugging Smashed Stack(s)  What To Do When You Face Stack Smashing?   Every minute of production downtime will generally cost a company money. If your application has a serious issue that causes stack smashing, you're in for a ride. Learn what stack smashing is upfront and what can be done about it!
  What Is Stack Smashing?  Working as a quality assurance engineer, one will sooner or later run into the term stack smashing."><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cayman/css/normalize.css><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel=stylesheet type=text/css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cayman/css/cayman.css><link rel=apple-touch-icon sizes=180x180 href=./apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=./favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=./favicon-16x16.png><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css integrity=sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js integrity=sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script></head><body><section class=page-header><h1 class=project-name>ZestW</h1><h2 class=project-tagline></h2><nav><a href=./index.html class=btn>Blog</a>
<a href=./sitemap.xml class=btn>Sitemap</a>
<a href=./index.xml class=btn>RSS</a></nav></section><section class=main-content><h1>What is Stack Smashing? Can it be Fixed?</h1><div><strong>Publish date: </strong>2024-06-01</div><h3>Quick Links</h3><ul class=table-content-level-1><li><a href=#>What Is Stack Smashing?</a></li></ul><ul class=table-content-level-1><li><a href=#>Debugging Smashed Stack(s)</a></li></ul><ul class=table-content-level-1><li><a href=#>What To Do When You Face Stack Smashing?</a></li></ul><p>Every minute of production downtime will generally cost a company money. If your application has a serious issue that causes stack smashing, you're in for a ride. Learn what stack smashing is upfront and what can be done about it!</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=what-is-stack-smashing>What Is <i>Stack Smashing</i>?</h2><p>Working as a quality assurance engineer, one will sooner or later run into the term <i>stack smashing</i>. As a developer, one will likely discover this term even earlier, especially if one has introduced a bug into the code, which causes a smashed stack. It is relatively easy (as in <i>'somewhat easy'</i>) for a developer to make a mistake that introduces stack smashing. As a user, when you learn about stack smashing, the damage is likely done already.</p><p>Stack smashing can happen involuntarily - for example, when the developer introduced a bug that caused stack smashing - or maliciously - an attacker somehow trying to overflow or corrupt the stack of a program.</p><p>Stack smashing is a somewhat loosely defined term that may point to various issues and can come from a variety of sources. The two most prominent issues which can cause stack smashing are; 1) to write/over-allocate too much data in a given part of the stack, thereby overwriting another part of the stack, and 2) where some external source (malicious or not) overwrote another program's stack, though this is much less common.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>So what is a stack? This, too, is a loosely defined term. Generally speaking, a stack refers to a program processing stack, a stack of functions as defined in a given software program/code.</p><p>Start by imagining a stack of bathroom tiles stacked up, ready to be used by a tiler. This is quite a good representation of a computer stack, with a few modifications. If each tile were a little offset from the previous one, it would be a better image, and we will soon see why.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/csit/2021/06/0cabe9ad.png><p>Picture that each stacked tile is a function in the computer program. The most basic function is on the bottom, and could be for example the</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre><code class=hljs>main()</code> </pre><p>function in a C or C++ program. C and C++ are two programming languages that use the stack extensively.</p><p>Each of these functions in the C/C++ program will have a name and likely a set of incoming variables and outgoing variables. In simplified terms, picture if one of those variables had a length of 10 characters, and some other function accidentally wrote 100 characters to that variable. This may corrupt the whole stack.</p><p>In terms of the tiles example above, imagine someone with a hammer hitting the first tile a little too hard and thereby smashing all the other tiles. Eh voila; stack smashing ;)</p><p>The analogy works because, just as all tiles are now broken in our fictive memory image, a smashed stack will result in <i>'broken functions'</i> if you will. Each tile offset is a function nested deeper - more on broken functions in the next section.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=debugging-smashed-stack-s>Debugging <i>Smashed Stack(s)</i></h2><p>Whereas technically a reference to <i>'broken functions'</i> may not be fully correct, i.e., there is likely only one broken function, and there may even be no broken function when there is an external attack or malfunctioning program, it is a great way to think about a smashed stack.</p><p>Suddenly, variable and function names may be mangled, and a backtrace (the flow of functions the computer took to arrive at a given function that crashed and (in our example) smashed the stack) does not make sense anymore.</p><p>Generally speaking, when we look at a backtrace, it will have a clear flow of functions which were called. While a crashing program cannot immediately be called 'healthy,' in terms of backtracing/debugging, this is what a 'healthy' backtrace looks like:</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/csit/2021/05/fb5c81ed-1.png> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>When a stack is corrupted, however, debugging becomes much harder. The stack may look like this:</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/csit/2021/05/602e8f04.png><p>This is an example stack smashing issue that happened in MySQL, the database server (see the</p><pre><code class="hljs css"><span class=hljs-selector-tag>log</span><span class=hljs-selector-class>.txt</span></code> </pre><p>attachment to <a href=#>MySQL Bug 37815</a> for the full output) in 2008, causing the database server daemon (</p><pre><code class=hljs>mysqld</code> </pre><p>) to terminate.</p><p>While the operating system's library</p><pre><code class="hljs css"><span class=hljs-selector-tag>libc</span><span class=hljs-selector-class>.so</span><span class=hljs-selector-class>.6</span></code> </pre><p>, in this case, seems to have handled the stack smashing quite well (using some fortify functionality in the</p><pre><code class=hljs>__fortify_fail</code> </pre><p>function), the issue existed somewhere in the code and has since been fixed.</p><p>Note also that in this case, we do not see resolved function names, we are only shown the binary name (interestingly, the issue seems to have been in the client (</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre><code class=hljs>mysql</code> </pre><p>) causing the server (</p><pre><code class=hljs>mysqld</code> </pre><p>) to terminate) which is</p><pre><code class=hljs>mysql</code> </pre><p>, together with a memory address of the function:</p><pre><code class="hljs css"><span class=hljs-selector-tag>mysql</span><span class=hljs-selector-attr>[0x8051565]</span></code> </pre><p>,</p><pre><code class="hljs css"><span class=hljs-selector-tag>mysql</span><span class=hljs-selector-attr>[0x80525c7]</span></code> </pre><p>and</p><pre><code class="hljs css"><span class=hljs-selector-tag>mysql</span>(<span class=hljs-selector-tag>main</span>+0<span class=hljs-selector-tag>x4f8</span>)<span class=hljs-selector-attr>[0x8053198]</span></code> </pre><p>.</p><p>Normally, when we use debug symbols (ref below for an article on GDB which explains what debug symbols are in detail), we would see function names with variables, and even with some levels of binary optimization/minification in place, we would at least see function names, just like what we see in the first 'healthy' backtrace above.</p><p>However, in the case of a smashed stack, output of the function names, variables names, or values are never guaranteed and often complete mumbo-jumbo :) We may even see different function names or a completely <i>mangled stack</i> (another lingo often used by IT folk) of different function names which do not make much sense (and are likely fictive/untrue as the stack was overwritten somehow).</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>This makes it harder on both the test engineer (who may end up with many different outcomes for a single bug, complicating known bug filtering mechanism handling) as well as the developer (who will likely have to use some step-by-step tracing or a reverse execution debugger like <a href=#>RR</a> to discover the bug at hand).</p><h2 id=what-to-do-when-you-face-stack-smashing>What To Do When You Face Stack Smashing?</h2><p>If you run into stack smashing, the first thing you want to do is understand the issue and environment a little better to know the source. If you have a popular web server exposed on the Internet with lots of gaming users who are trying to win a tournament whilst the server is also mining Bitcoin, you will want to assume the possibility of foul play and figure out if someone is messing with the server.</p><p>However, in most instances, the issue will be just an application error. Whilst I say <i>'just'</i>, the issue may be very significant, may result in downtime of services, could cost a lot of money, and finally may be unable to be fixed. For example, a database server may crash persistently when being started due to the data being in a given state in combination with a shortcoming or limitation in the code.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>If such a situation is compounded by not stack smashing, or in other words, not being able to generate a clean backtrace of the problem, debugging will be more involved and at times near impossible. Fear not, however, the same basic debugging as with any bug or application error/crash/issue remains the same.</p><p>Carefully read every bit of the log files before, during, and after the issue occurred. Take some backups and then retry the operation. Does it fail again or not? Research the errors, parts of the stack, and even the frames (i.e., individual stack functions shown, like the</p><pre><code class=hljs>do_the_maths</code> </pre><p>function in our original 'healthy' stack trace) can be put into your favorite search engines.</p><p>Concatenating (with a space) the most selective (top) crashing frames and searching for the same online often finds you an existing bug report for the issue you are facing. Still, in the case of stack smashing, likely these frames (function names) have become mangled and are therefore no longer usable in the same way. If you see an assertion message (a developer instituted assertion in the code) of any kind, search for that too.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Always log a new bug report if the issue does not appear to be logged online yet (you may be helping others who are seeing the same!) and supply as much information about the issue as you can find. Thousands of bug reports against just as many applications are logged online each day. Hopefully, the support team for your stack smashing application is at hand to help quickly.</p><p>You may also like to read our <a href=#>Debugging with GDB: Getting Started</a> article next, as it builds further upon how C and C++ programs (and others) can be debugged with the GDB debugger. It also further explains the concepts of a stack in detail.</p><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7qbvWraagnZWge6S7zGibnq6fpcBww8eaq2aho2LAta3CpGSspZGotaq6xmaamqZdnsFursRmnaKwlZl8</p><footer class=site-footer><span class=site-footer-credits>Made with <a href=https://gohugo.io/>Hugo</a>. © 2022. All rights reserved.</span></footer></section><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>